/// <reference path="../../common.ts" />

/**
 * {{es.accounts.item[0].name}}
 *
 * {{es.common.params.address}}
 * {{es.common.params.tag}}
 *
 * @example
 * =ES$ACCOUNT_BALANCE("0xAb5801a7D398351b8bE11C439e05C5B3259aeC9B", "latest")
 *
 * @returns {Wei}
 *
 * @customfunction
 */
function ES$ACCOUNT_BALANCE(
  address: EthereumAddress,
  tag?: EtherscanTag,
): SpreadsheetCell {
  return esRequest_<Wei>({
    caller: 'ES$ACCOUNT_BALANCE',
    action: 'balance',
    module: 'account',
    params: {
      address: validateEthereumAddress_(address),
      tag,
    },
  });
}
