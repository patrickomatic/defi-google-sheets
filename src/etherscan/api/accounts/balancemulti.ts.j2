/// <reference path="../../common.ts" />

interface EtherscanAccountBalanceMultiResponse {
  account: EthereumAddress;
  balance: Wei;
}

/**
 * {{es.accounts.item[1].name}}
 *
 * @param {EthereumAddress[]} addresses - A range or comma separated Ethereum addresses
 * {{common.params.fields}}
 * @param {fields} 
 * @param {tag} 
 *
 * @customfunction
 */
function ES$ACCOUNT_BALANCEMULTI(
  // XXX addresses can also be a comma-separated string
  addresses: EthereumAddress[],
  fields: FieldsOrAll<EtherscanAccountBalanceMultiResponse> = '*',
  tag?: EtherscanTag,
): SpreadsheetRow[] {
  return pickFields_({
    rows: esRequest_<EtherscanAccountBalanceMultiResponse[]>({
      caller: 'ES$ACCOUNT_BALANCEMULTI',
      action: 'balancemulti',
      module: 'account',
      params: {
        address: addresses.map(validateEthereumAddress_).join(','),
        tag,
      },
    }),
    fields,
  });
}
